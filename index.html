<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="robots" content="noindex, nofollow"> 
    
    <title>Boğaziçi Koleji Film Platformu (BETA)</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">
    
    <style>
        /* --- CSS AYARLARI --- */
        * { box-sizing: border-box; } 

        :root { 
            --bg-main: #f4f6f8; 
            --bg-card: #ffffff; 
            --text-main: #2c3e50; 
            --text-sec: #7f8c8d; 
            --accent: #2980b9; 
            --nav-bg: rgba(255, 255, 255, 0.95); 
            --border-color: #e0e0e0; 
            --overlay-color: rgba(244, 246, 248, 0.85); 
            --watched-color: #27ae60; 
            --trailer-color: #c0392b; 
            --beta-color: #e74c3c;
            --dublaj-color: #f1c40f;
            --progress-bg: #e0e0e0;
            --progress-fill: linear-gradient(90deg, #2980b9, #2ecc71);
            --report-color: #e67e22;
        }
        
        [data-theme="dark"] { 
            --bg-main: #141414; 
            --bg-card: #1f1f1f; 
            --text-main: #ffffff; 
            --text-sec: #b3b3b3; 
            --accent: #f39c12; 
            --nav-bg: rgba(15, 15, 15, 0.95); 
            --border-color: #333; 
            --overlay-color: rgba(20, 20, 20, 0.85);
            --progress-bg: #333;
        }
        
        body { 
            margin: 0; font-family: 'Roboto', sans-serif; 
            background-color: var(--bg-main); 
            color: var(--text-main); 
            transition: 0.3s;
            background-size: cover;
            background-attachment: fixed; 
            background-position: center;
            background-repeat: no-repeat;
            overflow-x: hidden; 
        }

        #app-container { display: flex; flex-direction: column; min-height: 100vh; }
        
        /* BETA TAG */
        .beta-tag {
            font-size: 0.6rem; color: #fff; background-color: var(--beta-color);
            padding: 2px 6px; border-radius: 4px; vertical-align: middle;
            margin-left: 8px; font-family: 'Roboto', sans-serif; font-weight: 700;
            letter-spacing: 1px; text-transform: uppercase; position: relative; top: -2px;
            box-shadow: 0 2px 5px rgba(231, 76, 60, 0.4);
        }

        /* YUMUŞAK TOAST BİLDİRİMLERİ */
        #toast-container {
            position: fixed; bottom: 30px; right: 30px; z-index: 10001;
            display: flex; flex-direction: column; gap: 15px;
        }
        .toast {
            background: var(--bg-card); color: var(--text-main);
            padding: 15px 25px; border-radius: 12px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border-left: 5px solid var(--accent);
            display: flex; align-items: center; gap: 15px;
            min-width: 280px; max-width: 350px; font-weight: 500; font-size: 0.95rem;
            opacity: 0; transform: translateY(20px); 
            animation: softFadeIn 0.5s ease-out forwards;
        }
        .toast.success { border-left-color: var(--watched-color); }
        .toast i { font-size: 1.4rem; }
        .toast.success i { color: var(--watched-color); }
        .toast.info i { color: var(--accent); }
        
        @keyframes softFadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes softFadeOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-20px); } }

        /* LOADER */
        #loader-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0f0f0f; z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease-out;
        }
        .loader-icon { font-size: 4rem; color: #f39c12; animation: spin 1.5s linear infinite; margin-bottom: 20px; }
        .loader-text { font-size: 1.2rem; font-weight: 500; color: #ffffff; letter-spacing: 1px; animation: pulse 1.5s infinite; font-family: 'Roboto', sans-serif; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* LOGIN EKRANI */
        #login-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9999; display: flex; justify-content: center; align-items: center;
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?auto=format&fit=crop&w=1920&q=80');
            background-size: cover; background-position: center;
        }
        .login-box { 
            position: relative; background: rgba(20, 20, 20, 0.75); 
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            padding: 3rem; border-radius: 20px; text-align: center; width: 340px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.6); border: 1px solid rgba(255, 255, 255, 0.1); 
            transition: transform 0.3s ease;
        }
        .login-box:hover { transform: translateY(-5px); border-color: rgba(255,255,255,0.3); }
        .motto-container { position: absolute; top: 15px; left: 20px; display: flex; align-items: center; gap: 6px; }
        .motto-icon { font-size: 1rem; color: #f39c12; filter: drop-shadow(0 0 2px rgba(0,0,0,0.5)); }
        .motto-text { font-family: 'Playfair Display', serif; font-style: italic; font-size: 0.9rem; color: #f39c12; margin: 0; letter-spacing: 0.5px; text-transform: lowercase; font-weight: normal; }
        .login-box h1 { margin: 0; color: #ffffff; font-size: 1.4rem; margin-bottom: 5px; font-weight: 700; letter-spacing: 1px; margin-top: 35px; display: flex; justify-content: center; align-items: center; }
        .login-box p.school-name { color: #b3b3b3; font-size: 0.85rem; margin-top: 5px; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 2px; }
        .login-box input { padding: 12px; width: 100%; margin-bottom: 20px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); outline: none; box-sizing: border-box; font-size: 1rem; color: #fff; transition: 0.3s; text-align: center; letter-spacing: 3px; font-weight: bold; }
        .login-box input:focus { background: rgba(255,255,255,0.2); border-color: var(--accent); box-shadow: 0 0 15px rgba(41, 128, 185, 0.4); }
        .login-box button { padding: 12px; width: 100%; background: var(--accent); color: #fff; border: none; cursor: pointer; border-radius: 8px; font-weight: 600; font-size: 1rem; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; }
        .login-box button:hover { background: #3498db; box-shadow: 0 0 20px rgba(52, 152, 219, 0.6); }
        #error-msg { color: #e74c3c; margin-top: 15px; font-weight: bold; font-size: 0.9rem; display: none; }
        
        /* NAVBAR */
        .navbar { background: var(--nav-bg); padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); backdrop-filter: blur(10px); }
        .logo { font-size: 1.5rem; font-weight: 700; display: flex; align-items: center; } 
        .logo .highlight { color: var(--accent); }
        .search-box { position: relative; width: 300px; }
        .search-box input { width: 100%; background: var(--bg-main); border: 1px solid var(--border-color); padding: 12px 40px 12px 20px; color: var(--text-main); border-radius: 30px; outline: none; }
        .search-box i { position: absolute; right: 20px; top: 12px; color: var(--text-sec); }
        .icon-btn { background: none; border: none; color: var(--text-main); font-size: 1.3rem; margin-left: 10px; cursor: pointer; transition: 0.3s; }
        .icon-btn:hover { color: var(--accent); transform: scale(1.1); }
        
        /* ISTATISTIK PANELİ */
        .stats-container {
            width: 95%; max-width: 1400px; margin: 20px auto 0 auto;
            background: var(--bg-card); padding: 15px 30px;
            border-radius: 20px; border: 1px solid var(--border-color);
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .user-level { display: flex; align-items: center; gap: 15px; }
        .level-badge {
            font-size: 2rem; background: var(--bg-main);
            width: 60px; height: 60px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            border: 2px solid var(--accent); color: var(--accent);
        }
        .level-info h4 { margin: 0; font-size: 0.9rem; color: var(--text-sec); text-transform: uppercase; }
        .level-info h2 { margin: 5px 0 0 0; font-size: 1.4rem; color: var(--text-main); font-weight: 900; }
        .progress-area { flex-grow: 1; margin: 0 40px; }
        .progress-text { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; font-weight: bold; color: var(--text-sec); }
        .progress-track { width: 100%; height: 10px; background: var(--progress-bg); border-radius: 10px; overflow: hidden; }
        .progress-bar { height: 100%; width: 0%; background: var(--progress-fill); transition: width 0.5s ease-out; }

        /* HERO SECTION */
        .hero-section {
            position: relative; width: 95%; max-width: 1400px; height: 450px;
            margin: 20px auto 10px auto; border-radius: 25px;
            background-size: cover; background-position: center top;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2); overflow: hidden;
            display: flex; align-items: center;
        }
        .hero-overlay {
            background: linear-gradient(90deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 50%, transparent 100%);
            width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center;
            padding: 0 60px; color: white; backdrop-filter: blur(3px);
        }
        .hero-badge {
            background-color: var(--accent); color: white; padding: 5px 15px; border-radius: 20px;
            font-size: 0.8rem; font-weight: bold; text-transform: uppercase; align-self: flex-start;
            margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .hero-title {
            font-size: 3rem; font-weight: 900; margin: 0 0 15px 0;
            text-shadow: 0 5px 15px rgba(0,0,0,0.5); font-family: 'Roboto', sans-serif;
            max-width: 70%; line-height: 1.1;
        }
        .hero-desc {
            font-size: 1.1rem; margin-bottom: 30px; max-width: 50%; line-height: 1.6;
            color: rgba(255,255,255,0.9); display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
        }
        .hero-btn {
            padding: 12px 35px; background: #fff; color: #000; border: none; border-radius: 30px;
            font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s;
            align-self: flex-start; display: flex; align-items: center; gap: 10px;
        }
        .hero-btn:hover { background: var(--accent); color: white; transform: scale(1.05); }

        /* ETİKET BULUTU */
        .tag-cloud { display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; padding: 20px 30px; background: transparent; }
        .tag-btn { 
            background: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-sec); 
            padding: 8px 20px; border-radius: 20px; cursor: pointer; transition: 0.3s; 
            font-size: 0.9rem; font-weight: 500; opacity: 0.9;
            display: flex; align-items: center; gap: 8px;
        }
        .tag-btn:hover, .tag-btn.active { background: var(--accent); color: white; border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); opacity: 1; }
        .tag-btn i { font-size: 0.95rem; }

        /* --- KART TASARIMI (IPHONE & SAMSUNG İÇİN GÜÇLENDİRİLMİŞ) --- */
        .movie-grid { 
            flex: 1; 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); 
            gap: 20px; 
            padding: 20px; 
            max-width: 1400px; 
            margin: 0 auto; 
            width: 100%; 
        }
        
        @media (min-width: 768px) {
            .movie-grid { 
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); 
                gap: 30px; padding: 30px;
            }
        }

        .movie-card { 
            background: var(--bg-card); 
            border-radius: 25px; 
            overflow: hidden; 
            transition: 0.3s; 
            position: relative; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); 
            border: 1px solid var(--border-color); 
            display: flex; 
            flex-direction: column; 
            /* İÇERİK SIĞMASI İÇİN SABİT YÜKSEKLİK YERİNE ESNEK YAPI */
            height: 100%; 
        }
        .movie-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }

        /* --- POSTER ALANI (KRİTİK DÜZELTME) --- */
        .poster-container { 
            width: 100%; 
            height: 240px; /* Mobil Varsayılan */
            /* IPHONE İÇİN EZİLMEYİ ENGELLEYEN KOMUT: */
            flex: 0 0 auto; 
            overflow: hidden; 
            position: relative; 
            cursor: pointer; 
        }
        
        @media (min-width: 768px) {
            .poster-container { height: 330px; }
        }

        .poster-container img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .movie-card:hover .poster-container img { transform: scale(1.05); }
        .play-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; opacity: 0; transition: 0.3s; }
        .movie-card:hover .play-overlay { opacity: 1; } .play-icon { font-size: 4rem; color: #fff; }
        .watched-badge { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.6); color: #fff; width: 35px; height: 35px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 10; transition: 0.3s; border: 2px solid rgba(255,255,255,0.3); }
        .watched-badge:hover { background: rgba(0,0,0,0.8); transform: scale(1.1); }
        .watched-badge.active { background: var(--watched-color); border-color: var(--watched-color); }
        
        /* --- KART BİLGİ ALANI --- */
        .card-info { 
            padding: 15px; 
            flex: 1 1 auto; /* Gerektiğinde uza */
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
        }
        .card-info h3 { margin: 0; font-size: 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 10px; font-weight: bold; }
        .tags { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px; }
        .tags span { background: var(--accent); color: #ffffff !important; font-size: 0.7rem; padding: 3px 8px; border-radius: 10px; font-weight: bold; display: inline-block; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        /* --- BUTONLAR (SAMSUNG İÇİN SARMA AYARI) --- */
        .watch-options { 
            display: flex; 
            gap: 8px; 
            padding: 0 15px 15px 15px; 
            margin-top: auto; 
            flex: 0 0 auto; /* Yüksekliği koru, ezilme */
            flex-wrap: wrap; /* Sığmazsa alt satıra geç */
        }
        .opt-btn { 
            flex: 1; 
            min-width: 60px; 
            background: var(--bg-main); 
            color: var(--text-main); 
            border: 1px solid var(--border-color); 
            padding: 8px 5px; 
            cursor: pointer; 
            border-radius: 10px; 
            font-weight: 600; 
            font-size: 0.8rem; 
            transition: 0.3s; 
            text-align: center;
        }
        .trailer-btn { flex-basis: 100%; margin-top: 2px; } /* Mobilde tam satır */
        
        @media (min-width: 768px) {
            .trailer-btn { flex-basis: auto; margin-top: 0; }
        }

        .dublaj-btn:hover, .dublaj-btn:active, .dublaj-btn:focus { background-color: var(--dublaj-color) !important; border-color: var(--dublaj-color) !important; color: #fff !important; }
        .altyazi-btn:hover, .altyazi-btn:active, .altyazi-btn:focus { background-color: var(--accent) !important; border-color: var(--accent) !important; color: #fff !important; }
        .trailer-btn { color: var(--trailer-color); border-color: var(--trailer-color); background: transparent; }
        .trailer-btn:hover { background: var(--trailer-color) !important; color: white !important; border-color: var(--trailer-color) !important; }

        /* SORUN BİLDİR BUTONU */
        .report-btn {
            background: linear-gradient(135deg, #e67e22, #d35400); 
            color: white; border: none; padding: 8px 16px;
            font-size: 0.85rem; font-weight: 600; border-radius: 20px;
            cursor: pointer; transition: all 0.3s ease;
            display: flex; align-items: center; gap: 8px;
            text-decoration: none; box-shadow: 0 4px 10px rgba(230, 126, 34, 0.3);
            margin-left: 10px; align-self: center;
        }
        .report-btn:hover { transform: translateY(-2px) scale(1.05); box-shadow: 0 6px 15px rgba(230, 126, 34, 0.5); }
        .report-btn i { animation: shake 2s infinite; }
        @keyframes shake { 0%, 100% { transform: rotate(0deg); } 10%, 30% { transform: rotate(-10deg); } 20%, 40% { transform: rotate(10deg); } 50% { transform: rotate(0deg); } }

        /* MODAL & SITEMAP */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; backdrop-filter: blur(5px); }
        .modal-content { background: var(--bg-card); width: 100%; max-width: 900px; border-radius: 25px; position: relative; max-height: 90vh; overflow-y: auto; color: var(--text-main); }
        .close-btn { position: absolute; top: 15px; right: 15px; width: 45px; height: 45px; background-color: #e74c3c; color: white; font-size: 26px; border-radius: 50%; text-align: center; line-height: 45px; cursor: pointer; z-index: 9999; transition: 0.3s; }
        .close-btn:hover { transform: rotate(90deg); background-color: #c0392b; }
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; background: #000; border-radius: 25px 25px 0 0; overflow: hidden; }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        .modal-info { padding: 30px; display: flex; flex-direction: column; }
        .controls-container { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px; margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--border-color); }
        .left-controls { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        .eval-button { display: inline-flex; align-items: center; gap: 8px; background: var(--accent); color: white; padding: 10px 25px; text-decoration: none; border-radius: 30px; font-weight: 600; font-size: 0.95rem; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: all 0.3s ease; }
        .eval-button:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.3); filter: brightness(1.1); }
        .imdb-badge { display: inline-flex; align-items: center; background-color: #F5C518; color: #000; padding: 4px 10px; border-radius: 5px; font-weight: 900; font-family: 'Roboto', sans-serif; font-size: 1rem; gap: 8px; line-height: 1; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .user-rating-box { display: flex; align-items: center; gap: 10px; background: var(--bg-main); padding: 8px 20px; border-radius: 30px; border: 1px solid var(--border-color); }
        .rating-label { font-size: 0.9rem; font-weight: bold; color: var(--text-sec); text-transform: uppercase; letter-spacing: 1px;}
        .stars { display: flex; gap: 5px; cursor: pointer; }
        .stars i { font-size: 1.2rem; color: #ccc; transition: 0.2s; }
        .stars i:hover, .stars i.hovered, .stars i.active { color: #f39c12; transform: scale(1.1); }
        
        .sitemap-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; padding: 20px 40px; }
        .sitemap-item { background: var(--bg-main); padding: 15px; border-radius: 10px; border: 1px solid var(--border-color); transition: 0.2s; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .sitemap-item:hover { background: var(--accent); color: #fff; transform: translateX(5px); }
        .sitemap-item i { color: var(--text-sec); }
        .sitemap-item:hover i { color: #fff; }

        #announcement-box { max-width: 450px !important; border-radius: 40px !important; text-align: center; background: var(--bg-card); border: 3px solid var(--accent); }
        .announcement-inner { padding: 50px; display: flex; flex-direction: column; align-items: center; }
        .announcement-icon { font-size: 5rem; color: var(--accent); margin-bottom: 30px; }
        footer { text-align: center; padding: 40px; background: var(--nav-bg); border-top: 1px solid var(--border-color); color: var(--text-sec); margin-top: auto; backdrop-filter: blur(10px); }

        /* MOBİL DÜZELTMELER (EKSTRA) */
        @media (max-width: 768px) {
            .navbar { flex-wrap: wrap; padding: 20px; } .logo { order: 1; flex: 1; } .nav-controls { order: 2; margin-left: 0; }
            .search-box { order: 3; width: 100%; margin-top: 20px; } .search-box input { width: 100%; box-sizing: border-box; }
            .movie-grid { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; padding: 20px; }
            .poster-container { height: 240px; }
            .controls-container { flex-direction: column; align-items: stretch; }
            .left-controls, .user-rating-box { justify-content: center; }
            .login-box { width: 85%; }
            .hero-section { height: 350px; padding: 20px; width: 90%; }
            .hero-title { font-size: 2rem; max-width: 100%; }
            .hero-desc { font-size: 1rem; max-width: 100%; -webkit-line-clamp: 4; }
            .hero-overlay { padding: 20px; }
            .stats-container { flex-direction: column; text-align: center; gap: 20px; padding: 20px; width: 90%; }
            .user-level { justify-content: center; }
            .progress-area { width: 100%; margin: 0; }
            .report-btn { margin-left: 0; margin-top: 10px; width: 100%; justify-content: center; }
            .left-controls { justify-content: center; width: 100%; }
            .eval-button { width: 100%; justify-content: center; margin-bottom: 10px; margin-right: 0 !important; }
        }
    </style>
</head>
<body>
    
    <div id="toast-container"></div>

    <div id="loader-screen">
        <i class="fas fa-film loader-icon"></i>
        <div class="loader-text">Boğaziçi Sinema Platformu Hazırlanıyor...</div>
    </div>

    <div id="login-overlay">
        <div class="login-box">
            <div class="motto-container">
                <i class="fas fa-feather-alt motto-icon"></i>
                <p class="motto-text">"de te fabula narratur!"</p>
            </div>
            <h1><i class="fas fa-play-circle" style="color: #3498db;"></i> Sinema Platformu <span class="beta-tag">BETA</span></h1>
            <p class="school-name">Boğaziçi Koleji</p>
            <input type="password" id="password-input" placeholder="PAROLA">
            <button onclick="checkPassword()">Sisteme Giriş Yap</button>
            <p id="error-msg"></p>
        </div>
    </div>

    <div id="app-container" style="display:none;">
        <nav class="navbar">
            <div class="logo">
                Boğaziçi Koleji <span class="highlight">&nbsp;Film Platformu</span> 
                <span class="beta-tag">BETA</span>
            </div>
            <div class="search-box"><input type="text" id="search-input" placeholder="Film ara..." onkeyup="filterFilms()"><i class="fas fa-search"></i></div>
            <div class="nav-controls">
                <button onclick="luckyDip()" class="icon-btn" title="Şansıma Ne Çıkarsa"><i class="fas fa-dice"></i></button> 
                <button onclick="openSitemap()" class="icon-btn" title="Site Haritası"><i class="fas fa-map"></i></button>
                <button onclick="openModal('announcement-modal')" class="icon-btn"><i class="fas fa-bell"></i></button>
                <button onclick="toggleTheme()" class="icon-btn"><i class="fas fa-moon"></i></button>
            </div>
        </nav>

        <div class="stats-container">
            <div class="user-level">
                <div class="level-badge"><i class="fas fa-compass"></i></div> <div class="level-info">
                    <h4>Macera Seviyesi</h4>
                    <h2 id="user-rank">Çaylak</h2>
                </div>
            </div>
            <div class="progress-area">
                <div class="progress-text">
                    <span>Yolculuk İlerlemesi</span>
                    <span id="progress-text">0 / 0 Film</span>
                </div>
                <div class="progress-track">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
            </div>
        </div>

        <div id="hero-section" class="hero-section" style="display:none;">
            <div class="hero-overlay">
                <span class="hero-badge"><i class="fas fa-star"></i> Haftanın Önerisi</span>
                <h1 class="hero-title" id="hero-title">Film Başlığı</h1>
                <p class="hero-desc" id="hero-desc">Film açıklaması buraya gelecek...</p>
                <button id="hero-btn" class="hero-btn" onclick=""><i class="fas fa-play"></i> Hemen İzle</button>
            </div>
        </div>

        <div class="tag-cloud">
            <button class="tag-btn active" onclick="filterGenre('all')"><i class="fas fa-th-large"></i> Tümü</button>
            <button class="tag-btn" onclick="filterGenre('Bilim Kurgu')"><i class="fas fa-atom"></i> Bilim Kurgu</button>
            <button class="tag-btn" onclick="filterGenre('Tarih')"><i class="fas fa-landmark"></i> Tarih</button>
            <button class="tag-btn" onclick="filterGenre('Dram')"><i class="fas fa-theater-masks"></i> Dram</button>
            <button class="tag-btn" onclick="filterGenre('Aksiyon')"><i class="fas fa-fire-alt"></i> Aksiyon</button>
            <button class="tag-btn" onclick="filterGenre('Belgesel')"><i class="fas fa-globe-europe"></i> Belgesel</button>
            <button class="tag-btn" onclick="filterGenre('Animasyon')"><i class="fas fa-magic"></i> Animasyon</button>
            <button class="tag-btn" onclick="filterGenre('Distopya')"><i class="fas fa-radiation"></i> Distopya</button>
        </div>

        <div class="movie-grid" id="movie-grid"></div>
        
        <footer>
            <div class="footer-content"><p>&copy; 2025 - Boğaziçi Koleji Sosyal Medya ve Bilişim Kulübü // Sadece eğitim amaçlı kullanılmak üzere kulübümüz tarafından tasarlanmıştır.</p></div>
        </footer>
    </div>

    <div id="player-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('player-modal')">&times;</span>
            <div class="video-wrapper"><iframe id="main-player" frameborder="0" allowfullscreen></iframe></div>
            <div class="modal-info">
                <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap;">
                    <h2 id="player-title" style="margin-top: 0; margin-right: 15px;"></h2>
                    <a href="https://forms.google.com" target="_blank" class="report-btn" title="Sorun Bildir">
                        <i class="fas fa-exclamation-triangle"></i> Sorun Bildir
                    </a>
                </div>
                
                <div id="player-tags" class="tags" style="margin-bottom:15px;"></div>
                <p id="player-desc" style="line-height:1.6; font-size:1.1rem;"></p>
                
                <div class="controls-container">
                    <div class="left-controls"></div>
                    
                    <div class="user-rating-box">
                        <span class="rating-label">Senin Puanın:</span>
                        <div class="stars" id="user-stars">
                            <i class="fas fa-star" onclick="rateMovie(1)" onmouseover="hoverStar(1)" onmouseout="resetStars()"></i>
                            <i class="fas fa-star" onclick="rateMovie(2)" onmouseover="hoverStar(2)" onmouseout="resetStars()"></i>
                            <i class="fas fa-star" onclick="rateMovie(3)" onmouseover="hoverStar(3)" onmouseout="resetStars()"></i>
                            <i class="fas fa-star" onclick="rateMovie(4)" onmouseover="hoverStar(4)" onmouseout="resetStars()"></i>
                            <i class="fas fa-star" onclick="rateMovie(5)" onmouseover="hoverStar(5)" onmouseout="resetStars()"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="sitemap-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close-btn" onclick="closeModal('sitemap-modal')">&times;</span>
            <div class="modal-info">
                <h2 style="margin-bottom: 20px; border-bottom: 2px solid var(--accent); padding-bottom: 10px;">
                    <i class="fas fa-map"></i> Site Haritası
                </h2>
                <div class="sitemap-container" id="sitemap-content"></div>
            </div>
        </div>
    </div>

    <div id="announcement-modal" class="modal">
        <div class="modal-content" id="announcement-box">
            <span class="close-btn" onclick="closeModal('announcement-modal')" style="background:var(--accent); top:15px; right:15px; border:none; color:white;">&times;</span>
            <div class="announcement-inner">
                <i class="fas fa-bullhorn announcement-icon"></i>
                <h3 style="font-size:1.8rem; margin-bottom:20px;">Duyurular</h3>
                <p style="font-size:1.2rem; line-height:1.6;">Merhaba arkadaşlar, Sitede gözden kaçırdığımız eksiklikler, hatalar olabilir. Bunları Tarih öğretmeni Murat Mutlu'ya bildirirseniz kısa sürede çözülecektir. Sosyal Medya ve Bilişim Kulübü</p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. AYARLAR ---
        const SITE_SIFRESI = "Murat1427";
        let currentMovieId = null; 

        // --- MERKEZİ LİNK YÖNETİMİ ---
        const TUR_LINKLERI = {
            "Bilim Kurgu": "form-bilimkurgu.html",
            "Dram": "form-dram.html",
            "Tarih": "form-tarih.html",
            "Aksiyon": "form-aksiyon.html",
            "Belgesel": "form-belgesel.html",
            "Animasyon": "form-animasyon.html",
            "Distopya": "form-distopya.html",
            "Genel": "form-genel.html" 
        };

        // --- FİLM LİSTESİ ---
        const filmler = [
            { id: 1, baslik: "The Martian (Marslı)", tur: ["Bilim Kurgu", "Aksiyon"], imdb: 8.0, ozet: "Mars'taki bir görev sırasında öldü sanılarak geride bırakılan astronot Mark Watney, zekasını ve botanik bilgisini kullanarak sınırlı kaynaklarla hayatta kalma mücadelesi verir.", poster: "https://upload.wikimedia.org/wikipedia/tr/7/7d/Marsl%C4%B1_-_afi%C5%9F.jpg", driveDublaj: "https://drive.google.com/file/d/1RKF2jzVQuvAZFKFQZWnFQRuVJVgJbLxq/preview", driveAltyazi: "https://drive.google.com/file/d/1x21b8Z5JI_3s3O6h6j-lhGJQv01F4qH-/preview" },
            { id: 2, baslik: "War Horse (Savaş Atı)", tur: ["Savaş", "Doğa", "Tarih"], imdb: 7.2, ozet: "I. Dünya Savaşı'nın başlamasıyla çok sevdiği sahibi Albert'tan ayrılarak orduya satılan Joey adlı bir atın, savaşın acımasız cephelerinde farklı tarafların hayatlarına dokunduğu destansı yolculuğunu anlatır.", poster: "https://upload.wikimedia.org/wikipedia/en/d/da/War-horse-poster.jpg", driveDublaj: "https://drive.google.com/file/d/1IYtbPkusrlDdzfefgHaMKL2e1lh_9Gmq/preview", driveAltyazi: "https://drive.google.com/file/d/16Fi2G6oen-DXNLMdmKWOmkxi6xJjlAt8/preview" },
            { id: 3, baslik: "Children of Men (Son Umut)", tur: ["Aksiyon", "Bilim Kurgu" ], imdb: 7.9, ozet: "Küresel kısırlık krizi nedeniyle insanlığın soyunun tükenme noktasına geldiği kaotik bir yakın gelecekte, hayattan umudunu kesmiş bir adam, insanlığın kaderini değiştirebilecek çok riskli bir görevi üstlenmek zorunda kalır.", poster: "https://m.media-amazon.com/images/M/MV5BMDNkNmNiYzYtYWY0YS00NWEwLTgwMWUtYjM0M2E4Nzk3MzhmXkEyXkFqcGc@._V1_FMjpg_UX1000_.jpg", driveDublaj: "https://drive.google.com/file/d/1kJ25HUtrjy_mGJ-IU9dHNieUqZP6sb6l/preview", driveAltyazi: "https://drive.google.com/file/d/1iIJrvhsCNNwdEXYM-FSkb9YpJ_lzBD3g/preview" },
            { id: 4, baslik: "Les Choristes (Koro)", tur: ["Müzik", "Dram"], imdb: 7.9, ozet: "İkinci Dünya Savaşı sonrası Fransa'da, katı bir yatılı okula atanan gözetmen Clément Mathieu, müziğin birleştirici gücünü kullanarak öğrencilerin hayatlarını değiştirmeye çalışır.", poster: "https://upload.wikimedia.org/wikipedia/tr/2/25/Chorus.jpg", driveDublaj: "https://drive.google.com/file/d/1S0BKXz2zrJfWFD5qgmH552PLshUP9pzV/preview", driveAltyazi: "https://drive.google.com/file/d/1S0BKXz2zrJfWFD5qgmH552PLshUP9pzV/preview" },
            { id: 5, baslik: "Rain Man (Yağmur Adam)", tur: ["Dram"], imdb: 8.0, ozet: "Babasının mirasının büyük kısmının, varlığından bile haberdar olmadığı otistik dahi kardeşi Raymond'a bırakıldığını öğrenen Charlie'nin hikayesi.", poster: "https://upload.wikimedia.org/wikipedia/en/b/b2/Rain_Man_poster.jpg", driveDublaj: "https://drive.google.com/file/d/107ovDbUJAb90HLfgU8y8oeYuSxTlKr-n/preview", driveAltyazi: "https://drive.google.com/file/d/1R9ppfdoab20fTUfBpWWsvh3cAAz2_UBP/preview" },
            { id: 6, baslik: "Ender's Game (Uzay Oyunları)", tur: ["Bilim Kurgu"], imdb: 6.6, ozet: "Uzaylı bir ırkın Dünya'ya saldırmasının ardından insanlığın geleceğini korumak isteyen ordu, üstün zekalı çocukları askeri bir okula toplayarak onları geleceğin komutanları olarak yetiştirmeye başlar.", poster: "https://upload.wikimedia.org/wikipedia/en/8/8c/Ender%27s_Game_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1T3uSugkt9E-U0Wlk7Qk96W143DBSIBIc/preview", driveAltyazi: "https://drive.google.com/file/d/1PcNjvkt6-uiYHDhwh5jj75PudxCwI9nK/preview" },
            { id: 7, baslik: "World War Z (Dünya Savaşı Z)", tur: ["Bilim Kurgu", "Distopya", "Uluslararası İlişkiler"], imdb: 7.0, ozet: "Gizemli bir virüsün insanları hızla saldırgan yaratıklara dönüştürerek medeniyetleri çöküşün eşiğine getirdiği bir dünyada, eski bir BM müfettişi olan Gerry Lane, ailesini ve insanlığı kurtarmak için göreve çağrılır.", poster: "https://upload.wikimedia.org/wikipedia/id/d/dc/World_War_Z_poster.jpg", driveDublaj: "https://drive.google.com/file/d/191t4uONNOcpcha9B_knoCpcgoAS_od61/preview", driveAltyazi: "https://drive.google.com/file/d/11HEES_qb4-3T3Aw_mJc79_n1gdDMtzUV/preview" },
            { id: 8, baslik: "Die Welle (Tehlikeli Oyun)", tur: ["11-12. Sınıflar!", "Politik Gerilim", "Psikolojik Dram"], imdb: 7.6, ozet: "Lise öğretmeni Rainer Wenger, öğrencilerine otokrasinin günümüzde hala mümkün olduğunu kanıtlamak amacıyla disiplin ve birlik üzerine kurulu, Dalga adını verdikleri bir sosyal deney başlatır.", poster: "https://upload.wikimedia.org/wikipedia/tr/1/1f/Tehlikeli-oyun.jpg", driveDublaj: "https://drive.google.com/file/d/19ij7Zy3Dq1iHqM4FtVv77Q-0wHrSyqE8/preview", driveAltyazi: "https://drive.google.com/file/d/10XsFKVr1r5yyRT6HqpWuWxJXcGo2QY-g/preview" },
            { id: 9, baslik: "Real Steel (Çelik Yumruklar)", tur: ["Bilim Kurgu", "Yapay Zeka"], imdb: 7.1, ozet: "İnsan boksörlerin yerini dev robotların aldığı yakın bir gelecekte, eski bir dövüşçü olan Charlie, hurda parçalardan yaptığı robotlarla geçimini sağlamaya çalışan, tükenmişlik içindeki bir adamdır.", poster: "https://upload.wikimedia.org/wikipedia/en/2/22/Real_Steel_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/1V719BBIt6I-qoMPdQJmf7OmPy8omSU9d/preview", driveAltyazi: "https://drive.google.com/file/d/1B3np7_typC_AaYHigbyftAJWEWNp1lfZ/preview" },
            { id: 10, baslik: "Karpuz Kabuğundan Gemiler Yapmak", tur: ["Dram", "Komedi"], imdb: 7.8, ozet: "1960'lı yılların bir Anadolu kasabasında yaşayan sinema aşığı iki genç çırak, gündüzleri karpuzculuk ve berberlik yaparken geceleri kendi filmlerini çekebilmek için büyük bir tutkuyla çalışırlar.", poster: "https://upload.wikimedia.org/wikipedia/tr/8/82/Karpuzkabugu_afis.jpg", driveDublaj: "https://drive.google.com/file/d/10csQ8uNWkd1znZYRhP0jccNuoIhgYVj-/preview", driveAltyazi: "https://drive.google.com/file/d/10csQ8uNWkd1znZYRhP0jccNuoIhgYVj-/preview" },
            { id: 11, baslik: "Elysium (Yeni Cennet)", tur: ["Bilim", "Aksiyon", "Distopya"], imdb: 6.6, ozet: "2154 yılında dünya nüfusu yoksulluk ve hastalıkla boğuşurken, zenginler Elysium adındaki lüks ve teknolojik bir uzay istasyonunda her türlü hastalıktan arınmış ayrıcalıklı bir yaşam sürmektedir.", poster: "https://upload.wikimedia.org/wikipedia/tr/f/f9/Elysium_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/1-QEtCLIDDgqONEy4EVVTidk2bCdIY-Qz/view?usp=sharing", driveAltyazi: "https://drive.google.com/file/d/1Y6SIw4L5IoiIfuDhWpnvC81uUdVFETZc/preview" },
            { id: 12, baslik: "Interstellar (Yıldızlararası)", tur: ["Bilim Kurgu", "Dram", "Aile"], imdb: 8.6, ozet: "Kuraklık ve iklim krizinin Dünya'yı yaşanmaz hale getirdiği bir gelecekte, eski bir NASA pilotu olan Cooper, insanlığa yeni bir ev bulabilmek için ailesini geride bırakarak bir grup kaşifle birlikte yıldızlararası bir yolculuğa çıkar.", poster: "https://upload.wikimedia.org/wikipedia/tr/b/bc/Interstellar_film_poster.jpg", driveDublaj: "", driveAltyazi: "https://drive.google.com/file/d/1aofZmcbV-nfIdCWXzV_FfTKkaoRdvgLR/preview" },
            { id: 13, baslik: "The Matrix", tur: ["Bilim Kurgu", "Yapay Zeka", "Distopya"], imdb: 8.7, ozet: "Gündüzleri sıradan bir yazılımcı, geceleri ise usta bir hacker olan Neo, yaşadığı dünyanın aslında insanlığı uyutmak için makineler tarafından yaratılmış sanal bir simülasyon olduğu gerçeğiyle yüzleşir.", poster: "https://upload-wikimedia-org.translate.goog/wikipedia/en/d/db/The_Matrix.png?_x_tr_sl=en&_x_tr_tl=tr&_x_tr_hl=tr&_x_tr_pto=tc", driveDublaj: "https://drive.google.com/file/d/1phDLjuzE6-n6wfzHfaQA92L1Mb_4I8uB/preview", driveAltyazi: "https://drive.google.com/file/d/1phDLjuzE6-n6wfzHfaQA92L1Mb_4I8uB/preview" },
            { id: 14, baslik: "Scent of a Woman", tur: ["Dram"], imdb: 8.0, ozet: "Paraya ihtiyacı olan kolej öğrencisi Charlie, Şükran Günü hafta sonunda görme engelli, karizmatik ama oldukça aksi bir emekli albay olan Frank Slade'e refakatçilik yapmayı kabul eder.", poster: "https://upload.wikimedia.org/wikipedia/en/9/91/Scent_of_a_Woman.jpg", driveDublaj: "https://drive.google.com/file/d/1jEioOUHhjWAEw1_c51MmctN7Ms_NYyW1/preview", driveAltyazi: "https://drive.google.com/file/d/1IYCBfalvCpRC_VsMtI8RnBNmvYhIPHU-/preview" },
            { id: 15, baslik: "How centuries of sci-fi sparked spaceflight", tur: ["Belgesel", "Bilim Kurgu"], imdb: 7.5, ozet: "NASA ekonomisti Alex MacDonald, uzay yolculuğunun sadece bilim insanlarının ve mühendislerin başarısı olmadığını anlatıyor.", poster: "https://cdn.bsky.app/img/feed_fullsize/plain/did:plc:q64mvrkbhen2tyxcovdsnexq/bafkreifhxu2jwa2p3esbmk7kxp7hvgarozgby2q64ur3w34op3xfvbwoxi@jpeg", driveDublaj: "https://drive.google.com/file/d/1Qw1o8_HhZulApH5PEG6hDdpqCUceWeZ4/preview", driveAltyazi: "https://drive.google.com/file/d/1Qw1o8_HhZulApH5PEG6hDdpqCUceWeZ4/preview" },
            { id: 16, baslik: "Tenkû no shiro Rapyuta (Gökteki Kale)", tur: ["Animasyon", "Doğa"], imdb: 8.0, ozet: "Hikaye, gizemli bir mavi kristal kolye sayesinde gökyüzünden süzülerek inen Sheeta adlı genç bir kızın, madenci çırağı olan cesur çocuk Pazu tarafından bulunmasıyla başlar.", poster: "https://www.kvmr.org/wp-content/uploads/2025/06/castle.png", driveDublaj: "https://drive.google.com/file/d/11XH6xGvFE3NZQNRilkt2bB1XvYr9dtup/preview", driveAltyazi: "https://drive.google.com/file/d/1HKP_cbS93a7tiB-UOWeuHuLFxVIg7NjM/preview" },
            { id: 17, baslik: "A Beautiful Mind (Akıl Oyunları)", tur: ["Dram", "Biyografi"], imdb: 8.2, ozet: "Nobel ödüllü matematikçi John Nash’in gerçek hayat hikayesinden esinlenen film, Nash'in dâhilikten şizofreniye uzanan hayatını konu alır.", poster: "https://upload.wikimedia.org/wikipedia/en/b/b8/A_Beautiful_Mind_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/1XFUZIeOQ6X5FPbyKJyAfXh4bCOWKBFW0/preview", driveAltyazi: "https://drive.google.com/file/d/145As5ZrjZZx9nqN2iZTKFJqD8FYPCFX9/preview" },
            { id: 18, baslik: " Avatar", tur: ["Bilim Kurgu", "Aksiyon"], imdb: 7.8, ozet: "22. yüzyılda Pandora uydusunda geçen filmde, felçli bir deniz piyadesi olan Jake Sully, Avatar programı aracılığıyla Pandora'nın yerlileri Na'vi halkının arasına sızar.", poster: "https://upload.wikimedia.org/wikipedia/tr/1/12/Avatar-Film-Posteri.jpg", driveDublaj: "https://drive.google.com/file/d/1wWRhS_wjRwjw-9nyluxv5ZAR59k-w491/preview", driveAltyazi: "https://drive.google.com/file/d/1dVuIPy91dOU39C9NwLCf79Yk4VaJBEws/preview" },
            { id: 19, baslik: "Coach Carter (Koç Carter)", tur: ["Biyografi", "Spor", "Dram"], imdb: 7.3, ozet: "Richmond Lisesi basketbol koçu Ken Carter, oyuncularının akademik başarılarını spor başarılarının önüne koyarak tartışmalı bir karar alır.", poster: "https://upload.wikimedia.org/wikipedia/en/c/c3/Coach_Carter_poster.JPG", driveDublaj: "https://drive.google.com/file/d/1nK1Rg66UftS9RLdkpDs56opwOBSdtt7b/preview", driveAltyazi: "https://drive.google.com/file/d/1txiGcAIHhBUt1BtUs0Ng7tGxMuesA2kk/preview" },
            { id: 20, baslik: "Freedom Writers (Özgürlük Yazarları)", tur: ["Biyografi", "Dram"], imdb: 7.5, ozet: "Genç bir öğretmen, ırkçılık ve şiddetin hüküm sürdüğü bir lisede öğrencilerine günlük tutturarak hayatlarını değiştirmeye çalışır.", poster: "https://upload.wikimedia.org/wikipedia/tr/7/73/FWPoster.jpg", driveDublaj: "https://drive.google.com/file/d/1ruMt3oA_ZUOswfXyhCi_2Jnago-7ifzr/preview", driveAltyazi: "https://drive.google.com/file/d/1RfHw56Yr3ZVP9D3anJzk6XKM8RSNseP9/preview" },
            { id: 21, baslik: "Gattaca", tur: ["Bilim Kurgu", "Distopya"], imdb: 7.8, ozet: "Genetik mühendisliğinin insanların kaderini belirlediği bir gelecekte, 'kusurlu' doğan bir adam astronot olma hayalini gerçekleştirmek için başkasının kimliğine bürünür.", poster: "https://upload.wikimedia.org/wikipedia/tr/b/bb/Gataca_Movie_Poster_B.jpg", driveDublaj: "https://drive.google.com/file/d/1x-tbeq6I6Zj9ZVp6kii3tGpe3gLP3-eP/preview", driveAltyazi: "https://drive.google.com/file/d/1h_iG_Yvnh8jgckZ_saxcRTGiDK1-66NY/preview" },
			{ id: 22, baslik: "Good Will Hunting (Can Dostum)", tur: ["Dram", "Psikolojik"], imdb: 8.3, ozet: "MIT'de hademelik yapan bir matematik dâhisi, bir terapistin yardımıyla geçmişiyle yüzleşir ve geleceğini şekillendirir.", poster: "https://upload.wikimedia.org/wikipedia/tr/1/17/Good_Will_Hunting_%28film%2C_1997%29.jpg", driveDublaj: "https://drive.google.com/file/d/1N7nKAWy05vL1bx3C64x0XY-lY0L-wiMe/preview", driveAltyazi: "https://drive.google.com/file/d/1N7nKAWy05vL1bx3C64x0XY-lY0L-wiMe/preview" },
            { id: 23, baslik: "Spider-Man: Into the Spider-Verse", tur: ["Animasyon", "Aksiyon"], imdb: 8.4, ozet: "Genç Miles Morales, farklı evrenlerden gelen diğer Örümcek-Adamlarla bir araya gelerek dünyayı kurtarmaya çalışır.", poster: "https://upload.wikimedia.org/wikipedia/en/f/fa/Spider-Man_Into_the_Spider-Verse_poster.png", driveDublaj: "https://drive.google.com/file/d/1wcnypHtNPO2bdemzGy77gakRrSD0roPv/view?usp=sharing", driveAltyazi: "https://drive.google.com/file/d/1HVRTjNxk0tlNT3lYY0YJUYEQ6wezmND3/preview" },
            { id: 24, baslik: "Inside Out (Ters Yüz)", tur: ["Animasyon", "Komedi", "Aile"], imdb: 8.1, ozet: "Genç bir kızın zihnindeki duyguların (Neşe, Üzüntü, Öfke vb.) maceralarını konu alan animasyon filmi.", poster: "https://upload.wikimedia.org/wikipedia/en/0/0a/Inside_Out_%282015_film%29_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1qHBR84WfG20U19uukUkrfaQr6RNkUPRN/preview", driveAltyazi: "https://drive.google.com/file/d/1RLv-2obe5-o51Fhyjv0INPmWTwgpI7yg/preview" },
            { id: 25, baslik: "Koe no Katachi (A Silent Voice)", tur: ["Anime", "Dram", "Gençlik"], imdb: 8.1, ozet: "Eskiden zorbalık yaptığı işitme engelli bir kızla yeniden iletişim kurmaya çalışan bir gencin kefaret hikayesi.", poster: "https://upload.wikimedia.org/wikipedia/en/3/32/A_Silent_Voice_Film_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/12Ny9MbFxU3ySzN6kDOWOS2ww0IQZs0XE/preview", driveAltyazi: "https://drive.google.com/file/d/12Ny9MbFxU3ySzN6kDOWOS2ww0IQZs0XE/preview" },
            { id: 26, baslik: "WALL-E", tur: ["Animasyon", "Bilim Kurgu", "Aile"], imdb: 8.4, ozet: "Gelecekte terk edilmiş dünyada çöp toplayan robot WALL-E'nin uzay macerasını anlatan Pixar filmi.", poster: "https://upload.wikimedia.org/wikipedia/en/4/4c/WALL-E_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1QSXgDf2sr4MKV3CyHiKOJXImQmeNRWZC/preview", driveAltyazi: "https://drive.google.com/file/d/1FQ-EUp_encMcz5vbDera1SKt3QFhWE1Z/preview" },
            { id: 27, baslik: "The Boy Who Harnessed the Wind", tur: ["Biyografi", "Dram"], imdb: 7.6, ozet: "Malawi'de yaşayan genç William Kamkwamba'nın, köyünü kıtlıktan kurtarmak için rüzgar türbini inşa etme hikayesi.", poster: "https://upload.wikimedia.org/wikipedia/en/4/44/The_Boy_Who_Harnessed_the_Wind.jpg", driveDublaj: "https://drive.google.com/file/d/1ez5FH-Fj7b9XBnhTuPC5hqAXW13CywP8/preview", driveAltyazi: "https://drive.google.com/file/d/1lRYYJjXDiHBAUAjwbW6qTOlOJarehBzJ/preview" },
            { id: 28, baslik: "Gladiator (Gladyatör)", tur: ["Tarih", "Dram", "Aksiyon"], imdb: 8.5, ozet: "İhanete uğrayan Romalı general Maximus'un, gladyatör olarak arenada yükselip intikam almasını konu alır.", poster: "https://upload.wikimedia.org/wikipedia/en/f/fb/Gladiator_%282000_film_poster%29.png", driveDublaj: "https://drive.google.com/file/d/1QQ9nGJIEcQuxOzpRiBlnUcGw-XStVGw6/preview", driveAltyazi: "https://drive.google.com/file/d/162Hh_muQDR1Zg6KsQNNOXqSuUzGjv0g7/preview" },
            { id: 39, baslik: "Kûsî jî dikarin bifirin", tur: ["Savaş", "Dram", "Tarih"], imdb: 8.0, ozet: "Irak işgali öncesinde mülteci kampında yaşayan çocukların savaşın gölgesindeki hayatlarını anlatır.", poster: "https://upload.wikimedia.org/wikipedia/tr/a/a5/Turtles_Can_Fly_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1So6d_8Pc2EnDOcxpU5p15uFdi4BMaEy4/preview", driveAltyazi: "https://drive.google.com/file/d/1So6d_8Pc2EnDOcxpU5p15uFdi4BMaEy4/preview" },
            { id: 30, baslik: "Sitaare Zameen Par", tur: ["Komedi", "Spor"], imdb: 8.3, ozet: "Zihinsel engelli bireylerden oluşan bir basketbol takımını çalıştıran koçun hikayesi.", poster: "https://upload.wikimedia.org/wikipedia/en/4/44/Sitaare_Zameen_Par_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1KRv-7g8sd-vcm_--zbs4F7toUT3aThtv/preview", driveAltyazi: "https://drive.google.com/file/d/1NGE0BeNgI973BZJDMqJ6z6ky0kU8a2kI/preview" },
            { id: 31, baslik: "Dangal", tur: ["Biyografi", "Spor", "Dram"], imdb: 8.3, ozet: "Eski güreşçi Mahavir Singh Phogat'ın kızlarını şampiyon güreşçi olarak yetiştirme mücadelesini anlatır.", poster: "https://upload.wikimedia.org/wikipedia/en/9/99/Dangal_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/11s3iIpcXMa6S4rnrbpVewULArpXziKlF/preview", driveAltyazi: "https://drive.google.com/file/d/11s3iIpcXMa6S4rnrbpVewULArpXziKlF/preview" },
            { id: 32, baslik: "Eternals", tur: ["Bilim Kurgu", "Fantastik"], imdb: 6.3, ozet: "Dünyayı binlerce yıldır koruyan ölümsüz bir ırkın, insanlığı kadim düşmanlarına karşı korumak için yeniden bir araya gelişini anlatır.", poster: "https://upload.wikimedia.org/wikipedia/en/9/9b/Eternals_%28film%29_poster.jpeg", driveDublaj: "https://drive.google.com/file/d/1GDoJk-2O1J6vlCSA49_6QqCMWkf9b44L/preview", driveAltyazi: "https://drive.google.com/file/d/1kevuMthsWclcQdSNj8mxYZuDAsK5dwRY/preview" },
            { id: 33, baslik: "Hidden Figures (Gizli Sayılar)", tur: ["Tarih", "Biyografi"], imdb: 7.8, ozet: "NASA'da çalışan üç dahi siyahi kadının, uzay yarışındaki kritik rollerini ve karşılaştıkları ayrımcılığı konu alır.", poster: "https://upload.wikimedia.org/wikipedia/en/4/4f/The_official_poster_for_the_film_Hidden_Figures%2C_2016.jpg", driveDublaj: "https://drive.google.com/file/d/1LGOsHL4GmRyqNDelOxO-JiY8bZUciW3O/preview", driveAltyazi: "https://drive.google.com/file/d/1XIWzeLme3rOtT-1pssSgiySJo2ULbIrk/preview" },
            { id: 34, baslik: "I Am Legend (Ben Efsaneyim)", tur: ["Bilim Kurgu", "Gerilim"], imdb: 7.2, ozet: "İnsanlığı yok eden bir virüsten sağ kalan tek insan olan Robert Neville'in hayatta kalma mücadelesi.", poster: "https://upload.wikimedia.org/wikipedia/en/d/df/I_am_legend_teaser.jpg", driveDublaj: "https://drive.google.com/file/d/1oeD9suufLnEsrHWbK0DIIZhP272w3ISl/preview", driveAltyazi: "https://drive.google.com/file/d/10WvUAPSfk0p9MIMxViMRXLo5O5-mhH0u/preview" },
            { id: 35, baslik: "Life of Pi (Pinin Yaşamı)", tur: ["Macera", "Fantastik"], imdb: 7.9, ozet: "Okyanusun ortasında bir filikada bengal kaplanıyla hayatta kalmaya çalışan Pi Patel'in büyüleyici hikayesi.", poster: "https://upload.wikimedia.org/wikipedia/en/5/57/Life_of_Pi_2012_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/1-taxYINEgU9kyI46xAUcL7dzx-zd-ejY/preview", driveAltyazi: "https://drive.google.com/file/d/1FcxgmfH2AtuQB_Fa-VPi-ZrA6d-HZ59V/preview" },
            { id: 36, baslik: "October Sky (Ekim Düşü)", tur: ["Biyografi", "Dram"], imdb: 7.8, ozet: "Madenci kasabasında yaşayan bir gencin, Sputnik uydusunu gördükten sonra roket yapma hayalinin peşinden gitmesini anlatır.", poster: "https://upload.wikimedia.org/wikipedia/en/7/73/October_sky_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1K_ExMIMw64xLI6W_H59g5EWdxixBusmz/preview", driveAltyazi: "https://drive.google.com/file/d/1SCa5D2J4-ikEUCzSgxy7Q0CnRt40SQLS/preview" },
            { id: 37, baslik: "Planet Earth I", tur: ["Belgesel", "Doğa"], ozet: "BBC tarafından hazırlanan, gezegenimizi daha önce hiç görülmemiş bir detay ve ölçekte gözler önüne serer.", poster: "https://m.media-amazon.com/images/I/71DxCxZ6tOL._SY445_.jpg", driveDublaj: "https://drive.google.com/file/d/1P7b9ocRYHNqBs6yZ5fRbZGwIq_Vlm5JZ/preview", driveAltyazi: "https://drive.google.com/file/d/1P7b9ocRYHNqBs6yZ5fRbZGwIq_Vlm5JZ/preview" },
            { id: 38, baslik: "Planet Earth II", tur: ["Belgesel", "Doğa"], ozet: "İlk seriden on yıl sonra, teknolojinin gelişmesiyle birlikte çekilen bu yapım, izleyiciyi doğanın içine daha önce hiç olmadığı kadar yakından sokmayı hedefler.", poster: "https://cms.bbcearth.com/sites/default/files/2020-11/Planet%20Earth%20II%20tile_592x888px.png", driveDublaj: "https://drive.google.com/file/d/19NIdudgR01nv37D8TCck96cIU-4FuYQF/preview", driveAltyazi: "https://drive.google.com/file/d/19NIdudgR01nv37D8TCck96cIU-4FuYQF/preview" },
            { id: 39, baslik: "Planet Earth III", tur: ["Belgesel", "Doğa"], ozet: "2023 yılında yayınlanan ve üçlemeyi tamamlayan bu yapım, doğanın güzelliğini ve dayanıklılığını merkeze alıyor.", poster: "https://m.media-amazon.com/images/I/91oRUQwOxCL._UF894,1000_QL80_.jpg", driveDublaj: "https://drive.google.com/file/d/1X9ajlUQhiR6J7BxVpW1fis9iTgb1X7bQ/preview", driveAltyazi: "https://drive.google.com/file/d/1X9ajlUQhiR6J7BxVpW1fis9iTgb1X7bQ/preview" },
            { id: 40, baslik: "Stardust (Yıldız Tozu)", tur: ["Fantastik", "Macera"], ozet: "Genç Tristan Thorn, sevdiği kadına bir yıldız getirmek için büyülü krallığa geçer ancak yıldızın bir insan olduğunu öğrenir.", poster: "https://upload.wikimedia.org/wikipedia/en/6/6f/Stardust_promo_poster.jpg", driveDublaj: "https://drive.google.com/file/d/1aUgksnqin4wld65U7L7TFS7DfrM5atFU/preview", driveAltyazi: "https://drive.google.com/file/d/1l0rioMYANWXUrWmoRmIx_hbjwBRA8JTy/preview" },
            { id: 41, baslik: "Snow White and the Huntsman", tur: ["Fantastik", "Aksiyon"], ozet: "Kötü kraliçe tarafından avlanmak istenen Pamuk Prenses, kendisini öldürmekle görevlendirilen Avcı ile işbirliği yapar.", poster: "https://upload.wikimedia.org/wikipedia/en/8/8f/Snow_White_and_the_Huntsman_Poster.jpg", driveDublaj: "https://drive.google.com/file/d/1TjihRkvOOd3ENQ4fsNQUOkam_j9LYVzS/preview", driveAltyazi: "https://drive.google.com/file/d/1qi1_7aSed1w4o7BPwcx_1btV55sjFA8V/preview" }
        ];

        document.addEventListener("DOMContentLoaded", () => {
            initFilms(filmler);
            setSeasonalBackground(); 
            if(localStorage.getItem('theme') === 'dark') document.body.setAttribute('data-theme', 'dark');
            if(localStorage.getItem('isLoggedIn') === 'true') {
                document.getElementById("login-overlay").style.display = "none";
                document.getElementById("app-container").style.display = "flex";
                updateProgress(); 
            }
            document.getElementById("password-input").addEventListener("keypress", (e) => { if(e.key === "Enter") checkPassword(); });
            setTimeout(hideLoader, 1500); 
            initHero();
        });

        window.onload = function() {
            hideLoader();
            if (window.stop) window.stop();
        };

        setTimeout(hideLoader, 4000);

        function hideLoader() {
            const loader = document.getElementById('loader-screen');
            if (loader) {
                loader.style.opacity = '0';
                setTimeout(() => { loader.style.display = 'none'; }, 800);
            }
        }

        // --- TOAST BİLDİRİM FONKSİYONU ---
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'fa-info-circle';
            if(type === 'success') icon = 'fa-check-circle';
            
            toast.innerHTML = `<i class="fas ${icon}"></i> <span>${message}</span>`;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'softFadeOut 0.5s ease-in forwards';
                setTimeout(() => { toast.remove(); }, 500);
            }, 3000);
        }

        function checkPassword() {
            if(document.getElementById("password-input").value === SITE_SIFRESI) {
                localStorage.setItem('isLoggedIn', 'true');
                document.getElementById("login-overlay").style.display = "none";
                document.getElementById("app-container").style.display = "flex";
                setSeasonalBackground();
                updateProgress();
                showToast("Sisteme Başarıyla Giriş Yapıldı!", "success");
            } else {
                const errorP = document.getElementById("error-msg");
                errorP.innerText = "Şifre Yanlış!";
                errorP.style.display = "block";
            }
        }

        function updateProgress() {
            const validFilms = filmler.filter(f => f.baslik !== "Deneme");
            const totalMovies = validFilms.length;
            let watchedCount = 0;

            validFilms.forEach(film => {
                if(localStorage.getItem('watched_' + film.id) === 'true') {
                    watchedCount++;
                }
            });

            const percentage = Math.round((watchedCount / totalMovies) * 100);
            document.getElementById("progress-text").innerText = `${watchedCount} / ${totalMovies} Film`;
            document.getElementById("progress-bar").style.width = `${percentage}%`;

            const rankTitle = document.getElementById("user-rank");
            if (watchedCount === 0) rankTitle.innerText = "Yeni Başlayan";
            else if (watchedCount <= 5) rankTitle.innerText = "Çaylak";
            else if (watchedCount <= 15) rankTitle.innerText = "Sinefil";
            else if (watchedCount <= 30) rankTitle.innerText = "Eleştirmen";
            else rankTitle.innerText = "Üstat";
        }

        function luckyDip() {
            const validFilms = filmler.filter(f => f.poster && f.poster.length > 5);
            if(validFilms.length > 0) {
                const randomFilm = validFilms[Math.floor(Math.random() * validFilms.length)];
                openPlayer(randomFilm.id, 'dublaj');
                showToast("Şanslı Filminiz Seçildi!", "info");
            }
        }

        function initHero() {
            const validFilms = filmler.filter(f => f.poster && f.poster.length > 5);
            if(validFilms.length > 0) {
                const heroFilm = validFilms[Math.floor(Math.random() * validFilms.length)];
                document.getElementById("hero-title").innerText = heroFilm.baslik;
                document.getElementById("hero-desc").innerText = heroFilm.ozet;
                const heroSection = document.getElementById("hero-section");
                
                heroSection.style.display = "flex"; 
                heroSection.style.backgroundImage = `url('${heroFilm.poster}')`;
                
                document.getElementById("hero-btn").onclick = function() {
                    openPlayer(heroFilm.id, 'dublaj');
                };
            }
        }
        
        function openSitemap() {
            const sitemapContainer = document.getElementById("sitemap-content");
            sitemapContainer.innerHTML = "";
            const sortedFilms = [...filmler].sort((a, b) => a.baslik.localeCompare(b.baslik));
            
            sortedFilms.forEach(film => {
                if(film.baslik !== "Deneme") {
                    const item = document.createElement("div");
                    item.className = "sitemap-item";
                    item.innerHTML = `<i class="fas fa-film"></i> <span>${film.baslik}</span>`;
                    item.onclick = () => {
                        closeModal('sitemap-modal');
                        openPlayer(film.id, 'dublaj');
                    };
                    sitemapContainer.appendChild(item);
                }
            });
            openModal('sitemap-modal');
        }

        function setSeasonalBackground() {
            if (document.getElementById("login-overlay").style.display !== "none") return;
            const month = new Date().getMonth(); 
            let season = '';
            if (month === 11 || month === 0 || month === 1) season = 'winter'; 
            else if (month >= 2 && month <= 4) season = 'spring'; 
            else if (month >= 5 && month <= 7) season = 'summer'; 
            else season = 'autumn'; 

            const backgroundImages = {
                winter: ['https://images.unsplash.com/photo-1478719059408-592965723cbc?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1517299321609-52687d1bc555?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1548777123-e213912bc5d1?auto=format&fit=crop&w=1920&q=80'],
                spring: ['https://images.unsplash.com/photo-1490750967868-58cb75069ed6?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1462275646964-a0e338679cde?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1506157786151-b8491531f063?auto=format&fit=crop&w=1920&q=80'],
                summer: ['https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1473496169904-658ba7c44d8a?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1520645521318-f03a712f5029?auto=format&fit=crop&w=1920&q=80'],
                autumn: ['https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1477414348463-c0eb7f1359b6?auto=format&fit=crop&w=1920&q=80', 'https://images.unsplash.com/photo-1508213271501-447be668c2d1?auto=format&fit=crop&w=1920&q=80']
            };
            const seasonImages = backgroundImages[season];
            const randomImage = seasonImages[Math.floor(Math.random() * seasonImages.length)];
            document.body.style.backgroundImage = `linear-gradient(var(--overlay-color), var(--overlay-color)), url('${randomImage}')`;
        }

        function initFilms(data) {
            const grid = document.getElementById("movie-grid");
            grid.innerHTML = "";
            data.forEach(film => {
                let posterSrc = film.poster;
                if(!film.poster || film.poster.includes("POSTER_LINKI")) { posterSrc = "https://via.placeholder.com/300x450?text=Resim+Yok"; }
                
                const div = document.createElement("div");
                div.className = "movie-card";
                const isWatched = localStorage.getItem('watched_' + film.id) === 'true';
                
                let tagsHtml = '';
                if (Array.isArray(film.tur)) { tagsHtml = film.tur.map(t => `<span>${t}</span>`).join(''); } 
                else if(film.tur) { tagsHtml = `<span>${film.tur}</span>`; }

                div.innerHTML = `
                    <div class="poster-container" onclick="openPlayer(${film.id}, 'dublaj')">
                        <img src="${posterSrc}" onerror="this.src='https://via.placeholder.com/300x450?text=Hata'">
                        <div class="play-overlay"><i class="fas fa-play-circle play-icon"></i></div>
                        <div class="watched-badge ${isWatched ? 'active' : ''}" onclick="toggleWatched(${film.id}, event)" title="İzlendi Olarak İşaretle"><i class="fas fa-check"></i></div>
                    </div>
                    <div class="card-info">
                        <h3>${film.baslik}</h3>
                        <div class="tags">${tagsHtml}</div>
                    </div>
                    <div class="watch-options">
                        <button class="opt-btn dublaj-btn" onclick="openPlayer(${film.id}, 'dublaj')">Dublaj</button>
                        <button class="opt-btn altyazi-btn" onclick="openPlayer(${film.id}, 'altyazi')">Altyazı</button>
                        <button class="opt-btn trailer-btn" onclick="openTrailer('${film.baslik}')"><i class="fab fa-youtube"></i> Fragman</button>
                    </div>`;
                grid.appendChild(div);
            });
        }

        function openTrailer(title) {
            const query = encodeURIComponent(title + " fragman türkçe altyazılı");
            window.open(`https://www.youtube.com/results?search_query=${query}`, '_blank');
        }

        function toggleWatched(id, event) {
            event.stopPropagation();
            const currentStatus = localStorage.getItem('watched_' + id) === 'true';
            localStorage.setItem('watched_' + id, !currentStatus);
            const btn = event.currentTarget;
            if(!currentStatus) {
                btn.classList.add('active');
                showToast("İzlenenlere Eklendi", "success");
            } else {
                btn.classList.remove('active');
                showToast("İzlenenlerden Çıkarıldı", "info");
            }
            updateProgress();
        }

        // --- GÜNCELLENMİŞ VE DÜZELTİLMİŞ openPlayer FONKSİYONU ---
        function openPlayer(id, type) {
            try {
                currentMovieId = id; 
                const film = filmler.find(f => f.id === id);
                const modal = document.getElementById("player-modal");
                document.getElementById("player-title").innerText = film.baslik;
                document.getElementById("player-desc").innerText = film.ozet;
                document.getElementById("player-imdb").innerText = film.imdb ? film.imdb : "-";
                
                let tagsHtml = '';
                if (Array.isArray(film.tur)) { tagsHtml = film.tur.map(t => `<span>${t}</span>`).join(''); } 
                else if (film.tur) { tagsHtml = `<span>${film.tur}</span>`; }
                document.getElementById("player-tags").innerHTML = tagsHtml;
                
                // --- OTOMATİK FORM BUTONLARI (GARANTİ METODU) ---
                // Modal içindeki sol kontrol alanını güvenli bir şekilde seçiyoruz
                const leftControls = modal.querySelector(".left-controls");
                
                if (leftControls) {
                    leftControls.innerHTML = ""; // İçini temizle

                    // 1. ADIM: Filmin türlerine göre butonları oluştur
                    let genres = [];
                    if (Array.isArray(film.tur)) { genres = film.tur; } 
                    else if (film.tur) { genres = [film.tur]; }
                    else { genres = ["Genel"]; } // Tür yoksa Genel varsay

                    genres.forEach(genre => {
                        let cleanGenre = genre.trim();
                        // Link sözlüğünden linki bul, yoksa genel forma yönlendir
                        let targetLink = (TUR_LINKLERI && TUR_LINKLERI[cleanGenre]) ? TUR_LINKLERI[cleanGenre] : "form-genel.html";
                        
                        const btn = document.createElement("a");
                        btn.href = targetLink;
                        btn.target = "_blank";
                        btn.className = "eval-button";
                        btn.innerHTML = `<i class="fas fa-edit"></i> ${cleanGenre} Değerlendir`;
                        btn.style.marginRight = "10px"; // Butonlar arası boşluk
                        btn.style.marginBottom = "5px"; // Alt alta gelirse diye boşluk
                        leftControls.appendChild(btn);
                    });

                    // 2. ADIM: IMDb Puanını Geri Ekle
                    const imdbDiv = document.createElement("div");
                    imdbDiv.className = "imdb-badge";
                    imdbDiv.innerHTML = `<span class="imdb-label">IMDb:</span><span class="imdb-score">${film.imdb || "-"}</span>`;
                    leftControls.appendChild(imdbDiv);
                }

                // ----------------------------------------------------

                const iframe = document.getElementById("main-player");
                iframe.src = (type === 'dublaj') ? film.driveDublaj : film.driveAltyazi;
                updateUserStars(id);
                modal.style.display = "flex";
            } catch (error) {
                console.error("Player açılırken hata oluştu:", error);
                // Hata olsa bile en azından modalı açmayı dene
                const modal = document.getElementById("player-modal");
                if(modal) modal.style.display = "flex";
            }
        }

        function rateMovie(score) {
            if(!currentMovieId) return;
            localStorage.setItem('vote_' + currentMovieId, score);
            updateUserStars(currentMovieId);
            showToast("Puanınız Kaydedildi!", "success");
        }

        function updateUserStars(id) {
            const savedScore = localStorage.getItem('vote_' + id);
            const stars = document.querySelectorAll("#user-stars i");
            stars.forEach((star, index) => {
                if (savedScore && index < savedScore) { star.classList.add("active"); } 
                else { star.classList.remove("active"); }
            });
        }

        function hoverStar(score) {
            const stars = document.querySelectorAll("#user-stars i");
            stars.forEach((star, index) => {
                if (index < score) { star.classList.add("hovered"); } 
                else { star.classList.remove("hovered"); }
            });
        }

        function resetStars() {
            const stars = document.querySelectorAll("#user-stars i");
            stars.forEach(star => star.classList.remove("hovered"));
        }

        function openModal(id) { document.getElementById(id).style.display = "flex"; }
        function closeModal(id) { 
            document.getElementById(id).style.display = "none"; 
            if(id === 'player-modal') {
                const iframe = document.getElementById("main-player");
                iframe.removeAttribute('src'); 
                currentMovieId = null;
            }
        }
        function toggleTheme() {
            const body = document.body;
            if(body.getAttribute('data-theme') === 'dark') { body.removeAttribute('data-theme'); localStorage.setItem('theme', 'light'); } 
            else { body.setAttribute('data-theme', 'dark'); localStorage.setItem('theme', 'dark'); }
        }
        function filterFilms() {
            const q = document.getElementById("search-input").value.toLowerCase();
            initFilms(filmler.filter(f => f.baslik.toLowerCase().includes(q)));
        }
        
        function filterGenre(genre) {
            document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            if(genre === 'all') { initFilms(filmler); } 
            else {
                const filtered = filmler.filter(f => {
                    if(Array.isArray(f.tur)) { return f.tur.includes(genre); } else { return f.tur === genre; }
                });
                initFilms(filtered);
            }
        }

        window.onclick = function(e) {
            if(e.target.classList.contains('modal')) {
                e.target.style.display = "none";
                if(event.target.id === 'player-modal') {
                    const iframe = document.getElementById("main-player");
                    iframe.removeAttribute('src');
                    currentMovieId = null;
                }
            }
        }

        // --- ESC TUŞU KONTROLÜ ---
        document.addEventListener('keydown', function(e) {
            if (e.key === "Escape") {
                closeModal('player-modal');
                closeModal('sitemap-modal');
                closeModal('announcement-modal');
            }
        });

    </script>
</body>
</html>
